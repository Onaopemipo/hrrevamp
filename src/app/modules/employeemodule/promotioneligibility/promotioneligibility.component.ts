import { AlertserviceService } from './../../../_services/alertservice.service';
import { NgForm } from '@angular/forms';
import { PromotionEligibilityViewModel, AddUpdateEligibleBucketServiceProxy, PromotionListServiceProxy, Sp_FetchEligibleEmployees } from './../../../_services/service-proxies';
import { Component, OnInit } from '@angular/core';

enum TOP_ACTIONS {
  ADD_NEW,
  INITIATE_VOLUNTARY_EXIT
}


@Component({
  selector: 'ngx-promotioneligibility',
  templateUrl: './promotioneligibility.component.html',
  styleUrls: ['./promotioneligibility.component.scss']
})
export class PromotioneligibilityComponent implements OnInit {
  showAddPlanModal = false;
  topActionButtons = [
    { name: TOP_ACTIONS.ADD_NEW, label: 'Add New', 'icon': 'plus', outline: false },

  ];

  tableColumns = [
    { name: 'a', title: 'S/N' },
    { name: 'b', title: 'NAME' },
    { name: 'c', title: 'DATE CREATED' },
    { name: 'd', title: 'GENERATED BY' },
    { name: 'e', title: 'STATUS' },

  ];

  promotionBucket: NgForm;
  promotionBucketList: PromotionEligibilityViewModel = new PromotionEligibilityViewModel().clone();
  eligibilityList: Sp_FetchEligibleEmployees [] = [];

  constructor(private promotion: AddUpdateEligibleBucketServiceProxy, private eligibilty: PromotionListServiceProxy,
    private alert: AlertserviceService) { }

  ngOnInit(): void {
    this.fetchEligibility();
  }

  async addToEligibilityList(){
    const data = await this.promotion.addUpdateEligibleBucket(this.promotionBucketList).toPromise()
    if(!data.hasError){

      console.log(data.message)
    }
  }

  async fetchEligibility(){
    const data = await this.eligibilty.promotionList(1,1).toPromise();
    if(!data.hasError){
      this.alert.openModalAlert('error','Data failure','Relaod')
      this.eligibilityList = data.result;
      console.log(this.eligibilityList)
    }
    else {
      console.log('Error has occured')
    }

  }

  modal(buttion) {
    if (buttion === TOP_ACTIONS.ADD_NEW) {
      this.showAddPlanModal = true;
    }
  //  if (buttion === TOP_ACTIONS.ADD_PLAN) {
     // this.showLeavePlanModal = true;
   // }
  }

}
